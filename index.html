<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Flappy Bird Clone</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background: #000;
    }
    canvas {
      display: block;
      margin: auto;
      touch-action: none;
    }
  </style>
</head>
<body>
  <canvas id="gameCanvas"></canvas>

  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");

    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    // Load gambar bg & burung (kamu siapkan sendiri)
    const bg = new Image();
    const bird = new Image();
    bg.src = "background.png";
    bird.src = "bird.png";

    // Bird
    let bX = 50;
    let bY = 150;
    let gravity = 1.5;
    let lift = -25;
    let velocity = 0;

    // Pipes
    let pipes = [];
    let pipeGap = 150;
    let pipeSpeed = 2;

    // Score
    let score = 0;
    let gameOver = false;

    // Controls
    function flap() {
      if (!gameOver) {
        velocity = lift;
      } else {
        location.reload(); // restart
      }
    }
    document.addEventListener("keydown", flap);
    canvas.addEventListener("touchstart", flap);

    // Pipe pertama
    pipes[0] = { x: canvas.width, y: 0 };

    function drawPipe(x, y, height, flip = false) {
      // Warna hijau pipa
      let grad = ctx.createLinearGradient(0, y, 0, y + height);
      grad.addColorStop(0, "#6ee16e");
      grad.addColorStop(1, "#2c962c");
      ctx.fillStyle = grad;

      // Batang pipa
      ctx.fillRect(x, y, 80, height);

      // Kepala pipa
      ctx.fillStyle = "#3ba63b";
      if (!flip) {
        ctx.fillRect(x - 5, y + height, 90, 20);
      } else {
        ctx.fillRect(x - 5, y - 20, 90, 20);
      }
    }

    function drawGround() {
      ctx.fillStyle = "#deb887";
      ctx.fillRect(0, canvas.height - 80, canvas.width, 80);
      ctx.fillStyle = "#3ba63b";
      ctx.fillRect(0, canvas.height - 85, canvas.width, 10);
    }

    function draw() {
      // Background
      ctx.drawImage(bg, 0, 0, canvas.width, canvas.height);

      for (let i = 0; i < pipes.length; i++) {
        let constant = 200 + pipeGap;

        // Pipa atas
        drawPipe(pipes[i].x, pipes[i].y, 200, true);
        // Pipa bawah
        drawPipe(pipes[i].x, pipes[i].y + constant, canvas.height, false);

        pipes[i].x -= pipeSpeed;

        if (pipes[i].x === canvas.width / 2) {
          pipes.push({
            x: canvas.width,
            y: Math.floor(Math.random() * -150)
          });
        }

        // Cek tabrakan
        if (
          (bX + bird.width >= pipes[i].x &&
            bX <= pipes[i].x + 80 &&
            (bY <= pipes[i].y + 200 ||
              bY + bird.height >= pipes[i].y + constant)) ||
          bY + bird.height >= canvas.height - 80
        ) {
          gameOver = true;
        }

        // Tambah skor
        if (pipes[i].x === 5) {
          score++;
        }
      }

      // Lantai
      drawGround();

      // Burung
      ctx.drawImage(bird, bX, bY);

      velocity += gravity;
      bY += velocity;

      // Skor
      ctx.fillStyle = "#fff";
      ctx.font = "30px Arial";
      ctx.fillText("Score : " + score, 10, canvas.height - 20);

      if (!gameOver) {
        requestAnimationFrame(draw);
      } else {
        ctx.fillStyle = "red";
        ctx.font = "50px Arial";
        ctx.fillText("Game Over", canvas.width / 2 - 150, canvas.height / 2);
        ctx.font = "24px Arial";
        ctx.fillText("Tap layar / tekan tombol untuk restart", canvas.width / 2 - 200, canvas.height / 2 + 40);
      }
    }

    draw();

    // Resize
    window.addEventListener("resize", () => {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    });
  </script>
</body>
</html>
